## 一、消息队列基础

### 1. 消息队列的作用？

1. **异步**
   将一部分业务异步处理，不占用系统资源，提升对用户请求的响应速度

2. **削峰/限流
   **先将短时间高并发产生的事务消息存储在消息队列中，然后后端服务再慢慢根据自己的能力去消费这些消息，这样就避免直接把后端服务打垮掉。

3. **解耦
   **一个复杂的系统往往有多个模块，如果模块之间存在直接调用，耦合性会很高。消息队列使用发布-订阅模式，可以实现消息生产者系统和消息消费者系统功能解耦。比如商城分为用户、订单、财务、仓储、消息通知、物流、风控等多个服务。用户在完成下单后，需要调用财务（扣款）、仓储（库存管理）、物流（发货）、消息通知（通知用户发货）、风控（风险评估）等服务。解耦下单流程...

4. **顺序性
   **保证数据按照特定顺序被处理

5.  **延时处理
   **消息发送后不会立即被消费，而是指定一个时间，到时间后再消费。**

   **

### 2. 如何保证消息的可靠性？

消息到 MQ 的过程中搞丢，MQ 自己搞丢，MQ 到消费过程中搞丢。

1. 生产者发布消息到RabbitMQ过程丢失：

1. 事务机制
2. Confirm 机制：RabbitMQ提供的一种消息确认机制，每当生产者发送一条消息后，RabbitMQ会异步地回传一个确认（ACK）或者失败（NACK）信息。
3. 将消息持久化到本地存储

1. RabbitMQ自身将信息丢失：

1. 持久化：将RabbitMQ的消息和队列都声明为持久化，即使服务器重启，消息也不会丢失
2. 镜像模式。

1. 消费者消费消息造成消息没有被处理：

1. basicAck 机制：消费者可以通知 RabbitMQ 已成功处理某条消息，从而 RabbitMQ 可以将这条消息从队列中安全地删除。如果消费者没有确认消息（如消费者崩溃或调用 basicNack），消息队列可以将该消息重新放回队列或放入**死信队列**等待重新处理。
   死信队列指的是：存储无法被正常消费的消息，让消费方去消费死信队列的消息。

### 3. 如何保证消息顺序性？

1. 单一生产者、单一消费者
2. 消息幂等性避免顺序问题

### 4. 如何保证消息幂等性？

幂等性指的是多次执行相同的操作结果不变，设计幂等性操作可以防止因重复处理而引发的数据问题

唯一订单ID或请求ID来标识每一个操作，并确保每个操作只执行一次。





## 二、RabbitMQ

### 1. 简单说说RabbitMQ原理？



## 三、Kafka